<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Management</title>

    <!-- Bootstrap CSS  -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    <!-- Font Awesome Kit -->
    <script src="https://kit.fontawesome.com/7013ed1e06.js" crossorigin="anonymous"></script>


    <!-- Select2 CSS -->
    <link href="assets/dist/css/select2.min.css" rel="stylesheet" />


    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>

    <!-- Select2 JS -->
    <script src="assets/dist/js/select2.min.js"></script>



    <script type="text/javascript" src="assets/daterangepicker-master/moment.min.js"></script>
    <script type="text/javascript" src="assets/daterangepicker-master/daterangepicker.js"></script>
    <link rel="stylesheet" type="text/css" media="all" href="assets/daterangepicker-master/daterangepicker.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<style>
    body {
        margin: auto;
        /* padding: 20px; */
        font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    }

    .main-container {
        padding: 10px;
    }

    .select2-container {
        z-index: 3060;
    }

    .input-field {
        position: relative;
    }

    .input-field input {
        width: 100%;
        height: 40px;
        border-radius: 3px;
        font-size: 18px;
        padding: 0 15px;
        border: 2px solid #bababa;
        background: transparent;
        color: #000000;
        outline: none;
    }

    .input-field label {
        position: absolute;
        top: 50%;
        left: 15px;
        transform: translateY(-50%);
        color: #212529;
        font-size: 16px;
        pointer-events: none;
        transition: 0.3s;
    }

    input:focus {
        border: 2px solid #0d6efd;
    }

    input:focus~label {
        color: #0d6efd;
    }

    input:focus~label,
    input:valid~label {
        top: 0;
        left: 15px;
        font-size: 16px;
        padding: 0 2px;
        background-color: white;
    }

    .required-field {
        border: 2px solid #f80000 !important;
    }

    body.offcanvas-active {
        overflow: hidden;
    }

    .dataTables_wrapper .dataTables_filter input {
        width: 300px;
        border: 2px solid #ced4da;
        border-radius: 5px;
        padding: 5px;
        margin-bottom: 10px;
        margin-right: 10px;
    }


    .select2-container {
        width: 100% !important;

    }

    .dataTables_length {
        margin-bottom: 10px;
    }

    .dataTables_length select {
        width: auto;
        border: 2px solid #ced4da;
        border-radius: 5px;
        padding: 5px;
    }

    .dataTables_length label {
        margin-right: 5px;
        font-weight: bolder;
    }

    /* table,
    tr,
    td{
        
                border: 1px solid rgb(136, 136, 136);
                border-collapse: collapse;
                width: fit-content;
                text-align: center;

            
    } */
</style>

<body>
    <div class="main-container">

        <br>

        <div class="container">
            <div class="row">
                <div class="col lg-2">
                    <button class="btn btn-primary" type="button" data-bs-toggle="offcanvas"
                        data-bs-target="#offcanvasRight" aria-controls="offcanvasRight"><i class="fa fa-plus"></i>
                        <b>Manage Plant</b>
                    </button>
                </div>
                <div class="col lg 8"></div>
                <div class="col-lg-2 col-md-4 col-sm-6 mt-3 mt-md-0">
                    <input class="form-control mr-sm-2" type="text" id="myInputx" placeholder="Search"
                        aria-label="Search " name="search">
                </div>
                <div class="col-lg-1 col-md-4 mt-3 mt-md-0" style="padding-left: 0px;">
                    <button class="btn btn-outline-success my-2 my-sm-0" type="submit">
                        <i class="fa fa-search" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
        </div>
        <br>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <table id="example" class="table  table-responsive table-hover">
                        <thead class="bg-gradient">
                            <tr>
                                <th class="text-center">Plant Name</th>
                                <th class="text-center">State</th>
                                <th class="text-center">Phone no</th>
                                <th class="text-center">Email Id</th>
                                <th class="text-center">Tax Id</th>
                                <th class="text-center">Action</th>
                            </tr>
                        </thead>
                        <tbody class="text-center" id="prodction_plan">
                        </tbody>
                    </table>
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-4 col-md-12 mb-2"></div>
                            <div class="col-lg-4 col-md-12 mb-2">
                                <nav aria-label="..." id="page1">
                                    <ul class="pagination justify-content-center" id="pagination1"></ul>
                                </nav>
                            </div>
                            <div class="col-lg-4 col-md-12 mb-2"></div>
                        </div>
                    </div>
                    <br>
                </div>
            </div>
        </div>
    </div>

    <!-- model for create production plan -->

    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasRightLabel">Add Plant</h5>

            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <hr>
        <div class="offcanvas-body">
            <div class="row">
                <div class="col-md-12">
                    <div class="input-field">
                        <input type="text" required="required" spellcheck="false" id="p_name">
                        <label for="p_name">Plant Name</label>
                    </div>
                    <br>
                    <div class="col-md-12">
                        <div class="input-field">
                            <select class="form-select select2" id="p_state" required="required">
                                <option value="" disabled selected>Select State</option>
                                <!-- List of states in India -->
                                <script>
                                    var indianStates = [
                                        "Andhra Pradesh", "Arunachal Pradesh", "Assam", "Bihar", "Chhattisgarh", "Goa", "Gujarat", "Haryana",
                                        "Himachal Pradesh", "Jharkhand", "Karnataka", "Kerala", "Madhya Pradesh", "Maharashtra", "Manipur",
                                        "Meghalaya", "Mizoram", "Nagaland", "Odisha", "Punjab", "Rajasthan", "Sikkim", "Tamil Nadu", "Telangana",
                                        "Tripura", "Uttar Pradesh", "Uttarakhand", "West Bengal", "Andaman and Nicobar Islands", "Chandigarh",
                                        "Dadra and Nagar Haveli", "Daman and Diu", "Lakshadweep", "Delhi", "Puducherry"
                                    ];

                                    indianStates.forEach(function (state) {
                                        document.write('<option value="' + state + '">' + state + '</option>');
                                    });
                                </script>
                            </select>
                            <label for="p_state">State</label>
                        </div>
                    </div>

                    <script>
                        $(document).ready(function () {
                            // Initialize Select2
                            $('.select2').select2();
                        });
                    </script>
                    <br>

                    <div class="col-md-12">
                        <div class="input-field">
                            <input type="text" required="required" spellcheck="false" id="p_pin_code">
                            <label for="p_pin_code">Pin Code</label>
                        </div>
                    </div>
                    <br>
                    <div class="md-12">
                        <div class="input-field">
                            <input type="text" required="required" spellcheck="false" id="p_ph_no">
                            <label for="p_ph_no">Phone Number</label>
                        </div>
                    </div>
                    <br>
                    <div class="md-12">
                        <div class="input-field">
                            <input type="text" required="required" spellcheck="false" id="p_email">
                            <label for="p_email">Email Id</label>
                        </div>
                    </div> <br>
                    <div class="col-md-12">
                        <div class="input-field">
                            <input type="text" required="required" spellcheck="false" id="p_tax_id">
                            <label for="p_tax_id">GST No</label>
                        </div>
                    </div>
                    <br>

                </div>
                <div class="row">
                    <button type="button" style="margin-left: 12px;" class="btn btn-primary "
                        onclick="addPlantData()"><i class="fa fa-check"></i> <b>Save</b> </button>
                </div>
                <br>
            </div>
        </div>
    </div>

    <script>
        function addPlantData() {
            var fields = ["p_name", "p_tax_id", "p_pin_code", "p_ph_no", "p_email", "p_state"];
            var hasEmptyField = false;

            for (var i = 0; i < fields.length; i++) {
                var fieldId = fields[i];
                var input = document.getElementById(fieldId);

                var value = input.value.trim();

                if (value === "") {
                    input.classList.add("required-field");
                    hasEmptyField = true;
                }
                else {
                    input.classList.remove("required-field");
                }
            }

            if (hasEmptyField) {
                return;
            }

            var p_name = document.getElementById("p_name").value;
            var p_tax_id = document.getElementById("p_tax_id").value;
            var p_pin_code = document.getElementById("p_pin_code").value;
            var p_ph_no = document.getElementById("p_ph_no").value;
            var p_email = document.getElementById("p_email").value;
            var p_state = document.getElementById("p_state").value;

            var JsonDataAddPlant =
            {
                plant_name: p_name,
                plant_taxID: p_tax_id,
                plant_pinCode: p_pin_code,
                plant_phoneNo: p_ph_no,
                plant_email: p_email,
                plant_state: p_state
            };

            console.log(JsonDataAddPlant);
            $('#p_state').val(null).trigger('change');

            document.getElementById("p_name").value = "";
            document.getElementById("p_tax_id").value = "";
            document.getElementById("p_pin_code").value = "";
            document.getElementById("p_ph_no").value = "";
            document.getElementById("p_email").value = "";
        }

    </script>

    <script>

        var dataTableInitialized = false;

        function updateTableData() {
            var xhr = new XMLHttpRequest();

            xhr.onreadystatechange = function () {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    if (xhr.status == 200) {
                        var response = xhr.responseText;
                        var jsonData = JSON.parse(response);
                        console.log(jsonData)
                        updateDataToTable(jsonData.add_plant);
                        displayTableRows();
                        // Initialize DataTables if it hasn't been initialized already
                    }


                }

            }
            xhr.open("GET", "17_manufacturing_plant.json", true)
            xhr.send();
        }

        function updateDataToTable(add_plant) {
            var tableBody = document.getElementById("prodction_plan")
            var data = add_plant;
            for (var i = 0; i < data.length; i++) {
                var datax = data[i];

                var p_add_plant = document.createElement("tr")

                var p_name = document.createElement("td");
                p_name.textContent = datax.p_name;
                p_add_plant.appendChild(p_name);

                var p_phone_no = document.createElement("td");
                p_phone_no.textContent = datax.p_state;
                p_add_plant.appendChild(p_phone_no);

                var p_state = document.createElement("td");
                p_state.textContent = datax.p_ph;
                p_add_plant.appendChild(p_state);

                var tax_id = document.createElement("td");
                tax_id.textContent = datax.p_email
                p_add_plant.appendChild(tax_id);

                var tax_id = document.createElement("td");
                tax_id.textContent = datax.p_tax_id
                p_add_plant.appendChild(tax_id);

                var action = document.createElement("td");
                action.innerHTML =
                    `<i class="fa fa-trash" style="cursor:pointer"></i>`;
                p_add_plant.appendChild(action);

                tableBody.appendChild(p_add_plant)
            }
        }
        updateTableData()
    </script>
    <script>
        function addRawItemData(rowIndex) {
            var delectCellRow = rowIndex
            console.log(delectCellRow);
        }
    </script>

    <script>
        $(document).ready(function () {
            $('.js-example-basic-single').select2();
        });
    </script>

    <script type="text/javascript">
        $(function () {

            var start = moment().subtract(29, 'days');
            var end = moment();

            function cb(start, end) {
                $('#reportrange span').html(
                    start.format('D MMMM, YYYY') + ' - ' + end.format('D MMMM, YYYY')
                );
            }

            $('#reportrange').daterangepicker({
                startDate: start,
                endDate: end,
                ranges: {
                    'Today': [
                        moment(), moment()
                    ],
                    'Last 7 Days': [
                        moment().subtract(6, 'days'),
                        moment()
                    ],
                    'Last 30 Days': [
                        moment().subtract(29, 'days'),
                        moment()
                    ]
                }
            }, cb);

            cb(start, end);

        });
    </script>
    <script>
        function searchTable() {
            var inputx = document
                .getElementById("myInputx")
                .value
                .toLowerCase();
            var rowsx = document.querySelectorAll("#example tbody tr");

            var found = false; // Variable to track if any matching rows are found

            for (var i = 0; i < rowsx.length; i++) {
                var rowx = rowsx[i];
                var rollNumberCellx = rowx.cells[1]
                    ? rowx
                        .cells[1]
                        .textContent
                        .toLowerCase()
                    : '';
                var customerNameCell = rowx.cells[3]
                    ? rowx
                        .cells[3]
                        .textContent
                        .toLowerCase()
                    : '';

                var selectDeviceCellx = rowx.cells[2]
                    ? rowx
                        .cells[2]
                        .textContent
                        .toLowerCase()
                    : '';

                if (rollNumberCellx.includes(inputx) || selectDeviceCellx.includes(inputx) || customerNameCell.includes(inputx)) {
                    rowx.style.display = "";
                    // displayTableRows();
                    found = true;
                } else {
                    rowx.style.display = "none";

                }
            }
            if (inputx === '') {
                currentPage = 1;
                displayTableRows();
            }

            var existingNoDataRow = document.getElementById("noDataRow");
            if (existingNoDataRow) {
                existingNoDataRow.remove();
            }

            // Create a new row for the "No data found" message
            if (!found) {

                var tableBody = document.querySelector("#example tbody");
                var noDataRow = tableBody.insertRow();
                var cell = noDataRow.insertCell(0);
                cell.colSpan = 7;
                cell.textContent = "No data found.";
                noDataRow.id = "noDataRow";
            }

        }
        var searchInput = document.getElementById("myInputx");
        searchInput.addEventListener("keyup", searchTable);
    </script>
    <script>
        var currentPage = 1;
        var rowsPerPage = 10;
        var pagesToShow = 5; // Number of pages to display in the pagination

        function displayTableRows() {
            var tableRows = document.querySelectorAll('#prodction_plan tr');
            var totalPages = Math.ceil(tableRows.length / rowsPerPage);

            // Update the pagination based on the total number of pages
            var paginationList = document.querySelector('.pagination');
            paginationList.innerHTML = ''; // Clear existing items

            // Add Previous button
            var previousButton = document.createElement('li');
            previousButton.className = 'page-item';
            previousButton.id = 'previousButton';
            previousButton.innerHTML = '<a class="page-link" href="#">Previous</a>';
            previousButton.addEventListener('click', previousPage); // Add event listener
            paginationList.appendChild(previousButton);

            // Calculate the start and end page numbers to display
            var startPage = Math.max(1, currentPage - Math.floor(pagesToShow / 2));
            var endPage = Math.min(startPage + pagesToShow - 1, totalPages);

            // Add page items dynamically
            for (var i = startPage; i <= endPage; i++) {
                var pageItem = document.createElement('li');
                pageItem.className = 'page-item';
                if (i === currentPage) {
                    pageItem
                        .classList
                        .add('active');
                }
                var pageLink = document.createElement('a');
                pageLink.className = 'page-link';
                pageLink.href = '#';
                pageLink.textContent = i;
                pageLink.onclick = function () {
                    goToPage(parseInt(this.textContent));
                };
                pageItem.appendChild(pageLink);
                paginationList.appendChild(pageItem);
            }

            // Add Next button
            var nextButton = document.createElement('li');
            nextButton.className = 'page-item';
            nextButton.id = 'nextButton';
            nextButton.innerHTML = '<a class="page-link" href="#">Next</a>';
            nextButton.addEventListener('click', nextPage); // Add event listener
            paginationList.appendChild(nextButton);

            // Show/hide table rows based on current page
            var startIndex = (currentPage - 1) * rowsPerPage;
            var endIndex = startIndex + rowsPerPage;
            for (var i = 0; i < tableRows.length; i++) {
                if (i >= startIndex && i < endIndex) {
                    tableRows[i].style.display = 'table-row';
                } else {
                    tableRows[i].style.display = 'none';
                }
            }
        }

        function goToPage(pageNumber) {
            currentPage = pageNumber;
            displayTableRows();
        }

        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                displayTableRows();
            }
        }

        function nextPage() {
            var tableRows = document.querySelectorAll('#prodction_plan tr');
            var totalPages = Math.ceil(tableRows.length / rowsPerPage);

            if (currentPage < totalPages) {
                currentPage++;
                displayTableRows();
            }
        }

        // Call displayTableRows() after defining the functions
        displayTableRows();
    </script>

</body>

</html>